import { useState } from 'react';
import { AccountView, IAccount } from '../../components/AccountView';
import { HoldingView, IHolding } from '../../components/HoldingView';
import { NetworthChart } from '../../components/NetworthChart';
import './Networth.css';


export const Networth: React.FC = () => {
    const [holdingsFilterType, setHoldingsFilterType] = useState<string>("All");
    const [holdingsFilterValue, setHoldingsFilterValue] = useState<string>("All");

    let filteredHoldings = holdings;
    if(!(holdingsFilterType === "All")) {
        filteredHoldings = holdings.filter((record) => applyFilterToRecord(record, holdingsFilterType, holdingsFilterValue));
    }

    let holdingsFilterScope = '';
    switch(holdingsFilterType) {
        case 'account': holdingsFilterScope = holdingsFilterValue; break;
        default: holdingsFilterScope = holdingsFilterValue + " Accounts"; break;
    }

    return (
    <div className='networth scrollable'>
        <div className='networth--main scrollable'>
            <NetworthChart labels={labels} balances={balances} />
            <AccountView 
                asOfDate={{ day: 31, month: 3, year: 2024 }}
                accounts={accounts}
                holdings={holdings}
                filterType={holdingsFilterType}
                filterValue={holdingsFilterValue}
                setFilterType={setHoldingsFilterType}
                setFilterValue={setHoldingsFilterValue}
            />
        </div>
        <div className='networth--secondary scrollable'>
            <HoldingView holdings={filteredHoldings} scope={holdingsFilterScope} />
        </div>
    </div>
    );
};

const applyFilterToRecord = (record: IHolding, holdingsFilterType: string, holdingsFilterValue: string) => {
    switch(holdingsFilterType) {
        case 'accountTypeCategory':
            return(accounts[record.accountId].accountTypeCategoryName === holdingsFilterValue);
        case 'account':
            return(record.accountName === holdingsFilterValue);
        default:
            // TODO: Throw exception
            console.log("INVALID holdingsFilterType");
        }
}


const holdings: IHolding[] = [
    {
        holdingId: "1",
        securityId: "1",
        shortName: "91279768",
        name: "6mo Tsy Bill 2024-03-07 5.487%",
        assetClass: "Fixed Income -> US -> Treasuries -> Short Term",
        accountId: "2",
        accountName: "Peter's Investments",
        balance: 24832,
        quantity: 250.676,
        price: 99.06,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: .023,
    },
    {
        holdingId: "2",
        securityId: "2",
        shortName: "91279633",
        name: "6mo Tsy Bill 2024-04-18 5.394%",
        assetClass: "Fixed Income -> US -> Treasuries -> Short Term",
        accountId: "2",
        accountName: "Peter's Investments",
        balance: 19691,
        quantity: 199.99,
        price: 98.46,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: -.018,
    },
    {
        holdingId: "12",
        securityId: "10",
        shortName: "GLDM",
        name: "SPDR Gold Minishares Trust ETF",
        assetClass: "Commodities -> Gold",
        accountId: "6",
        accountName: "Dina's 401k",
        balance: 14253,
        quantity: 356.24,
        price: 40.01,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .035,
    },
    {
        holdingId: "3",
        securityId: "3",
        shortName: "AAPL",
        name: "Apple Inc.",
        assetClass: "Equities -> US -> Large Cap",
        accountId: "4",
        accountName: "Dina's Investments",
        balance: 11000,
        quantity: 56.576,
        price: 194.43,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: .002,
    },
    {
        holdingId: "4",
        securityId: "4",
        shortName: "BTC",
        name: "Bitcoin",
        assetClass: "Crypto -> Currency",
        accountId: "5",
        accountName: "Peter's Crypto",
        balance: 24250,
        quantity: .615,
        price: 39425.12,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: -.034,
    },
    {
        holdingId: "5",
        securityId: "5",
        shortName: "N/A",
        name: "Cash",
        assetClass: "Cash Equivalent -> Checking/Savings",
        accountId: "1",
        accountName: "Peter's Savings",
        balance: 11000,
        quantity: 11000,
        price: 1,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: 0.0,
    },
    {
        holdingId: "6",
        securityId: "5",
        shortName: "N/A",
        name: "Cash",
        assetClass: "Cash Equivalent -> Checking/Savings",
        accountId: "2",
        accountName: "Peter's Investments",
        balance: 152,
        quantity: 152,
        price: 1,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: 0.0,
    },
    {
        holdingId: "7",
        securityId: "5",
        shortName: "N/A",
        name: "Cash",
        assetClass: "Cash Equivalent -> Checking/Savings",
        accountId: "3",
        accountName: "Joint Checking",
        balance: 12230,
        quantity: 12230,
        price: 1,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: -.061,
    },
    {
        holdingId: "8",
        securityId: "6",
        shortName: "N/A",
        name: "Freshbooks Inc.",
        assetClass: "Private Investment -> Private Equity -> Direct",
        accountId: "2",
        accountName: "Peter's Investments",
        balance: 20000,
        quantity: 20000,
        price: 1,
        lastQuantityUpdateDate: { day: 31, month: 8, year: 2022 },
        lastPriceUpdateDate: { day: 31, month: 8, year: 2022 },
        ytdChangePercentage: 0.0,
    },
    {
        holdingId: "9",
        securityId: "7",
        shortName: "MSFT",
        name: "Microsoft Corporation",
        assetClass: "Equities -> US -> Large Cap",
        accountId: "4",
        accountName: "Dina's Investments",
        balance: 21250,
        quantity: 52.5,
        price: 404.75,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: .012,
    },
    {
        holdingId: "10",
        securityId: "8",
        shortName: "O",
        name: "Realty Income Corporation",
        assetClass: "Equities -> US -> REIT",
        accountId: "6",
        accountName: "Dina's 401k",
        balance: 8210,
        quantity: 148.52,
        price: 55.28,
        lastQuantityUpdateDate: { day: 31, month: 3, year: 2024 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: .029,
    },
    {
        holdingId: "11",
        securityId: "9",
        shortName: "N/A",
        name: "Spartan Self Storage Debt Fund",
        assetClass: "Private Investment  -> Real Estate -> Self Storage",
        accountId: "2",
        accountName: "Peter's Investments",
        balance: 100000,
        quantity: 100000,
        price: 1,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .045,
    },
    {
        holdingId: "13",
        securityId: "10",
        shortName: "GLDM",
        name: "SPDR Gold Minishares Trust ETF",
        assetClass: "Commodities -> Gold",
        accountId: "7",
        accountName: "Peter's IRA",
        balance: 45980,
        quantity: 1149.21,
        price: 40.01,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: -.002,
    },
    {
        holdingId: "14",
        securityId: "11",
        shortName: "N/A",
        name: "Sunrise MHP Fund III",
        assetClass: "Private Investment -> Real Estate -> MHP",
        accountId: "2",
        accountName: "Peter's Investments",
        balance: 50000,
        quantity: 50000,
        price: 1,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 3, year: 2024 },
        ytdChangePercentage: .065,
    },
    {
        holdingId: "15",
        securityId: "12",
        shortName: "VGLT",
        name: "Vanguard Long Term Treasury ETF",
        assetClass: "Fixed Income -> US -> Treasuries -> Long Term",
        accountId: "7",
        accountName: "Peter's IRA",
        balance: 32154,
        quantity: 546.28,
        price: 58.86,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: -.037,
    },
    {
        holdingId: "16",
        securityId: "13",
        shortName: "VIOV",
        name: "Vanguard S&P Small Cap 600 Value",
        assetClass: "Equities -> US -> Small Cap -> Value",
        accountId: "6",
        accountName: "Dina's 401k",
        balance: 23344,
        quantity: 270.84,
        price: 86.19,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .082,
    },
    {
        holdingId: "17",
        securityId: "13",
        shortName: "VIOV",
        name: "Vanguard S&P Small Cap 600 Value",
        assetClass: "Equities -> US -> Small Cap -> Value",
        accountId: "7",
        accountName: "Peter's IRA",
        balance: 11901,
        quantity: 138.08,
        price: 86.19,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: -.047,
    },
    {
        holdingId: "18",
        securityId: "13",
        shortName: "VIOV",
        name: "Vanguard S&P Small Cap 600 Value",
        assetClass: "Equities -> US -> Small Cap -> Value",
        accountId: "8",
        accountName: "Dina's Roth 401k",
        balance: 43250,
        quantity: 501.8,
        price: 86.19,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .022,
    },
    {
        holdingId: "19",
        securityId: "13",
        shortName: "VIOV",
        name: "Vanguard S&P Small Cap 600 Value",
        assetClass: "Equities -> US -> Small Cap -> Value",
        accountId: "9",
        accountName: "Peter's Roth IRA",
        balance: 75120,
        quantity: 871.56,
        price: 86.19,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .033,
    },
    {
        holdingId: "20",
        securityId: "14",
        shortName: "VTI",
        name: "Vanguard Total Stock market ETF",
        assetClass: "Equities -> US -> Large Cap -> Blend",
        accountId: "4",
        accountName: "Dina's Investments",
        balance: 12000,
        quantity: 49.42,
        price: 242.84,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .098,
    },
    {
        holdingId: "21",
        securityId: "14",
        shortName: "VTI",
        name: "Vanguard Total Stock market ETF",
        assetClass: "Equities -> US -> Large Cap -> Blend",
        accountId: "7",
        accountName: "Peter's IRA",
        balance: 22383,
        quantity: 92.17,
        price: 242.84,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .0011,
    },
    {
        holdingId: "22",
        securityId: "14",
        shortName: "VTI",
        name: "Vanguard Total Stock market ETF",
        assetClass: "Equities -> US -> Large Cap -> Blend",
        accountId: "8",
        accountName: "Dina's Roth 401k",
        balance: 73229,
        quantity: 301.55,
        price: 242.84,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .045,
    },
    {
        holdingId: "23",
        securityId: "14",
        shortName: "VTI",
        name: "Vanguard Total Stock market ETF",
        assetClass: "Equities -> US -> Large Cap -> Blend",
        accountId: "9",
        accountName: "Peter's Roth IRA",
        balance: 104899,
        quantity: 431.97,
        price: 242.84,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .076,
    },
    {
        holdingId: "24",
        securityId: "15",
        shortName: "VB",
        name: "Vanguard Small-Cap ETF",
        assetClass: "Equities -> US -> Small Cap -> Blend",
        accountId: "6",
        accountName: "Dina's 401k",
        balance: 14331,
        quantity: 67.95,
        price: 210.89,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .023,
    },
    {
        holdingId: "25",
        securityId: "16",
        shortName: "VXUS",
        name: "Vanguard Total International Stock ETF",
        assetClass: "Equities -> Int'l -> Large Cap -> Blend",
        accountId: "7",
        accountName: "Peter's IRA",
        balance: 51231,
        quantity: 866.41,
        price: 59.13,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .32,
    },
    {
        holdingId: "26",
        securityId: "17",
        shortName: "VOO",
        name: "Vanguard S&P 500 ETF",
        assetClass: "Equities -> US -> Large Cap -> Blend",
        accountId: "8",
        accountName: "Dina's Roth 401k",
        balance: 10232,
        quantity: 21.73,
        price: 470.83,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .063,
    },
    {
        holdingId: "27",
        securityId: "17",
        shortName: "VOO",
        name: "Vanguard S&P 500 ETF",
        assetClass: "Equities -> US -> Large Cap -> Blend",
        accountId: "9",
        accountName: "Peter's Roth IRA",
        balance: 43200,
        quantity: 91.75,
        price: 470.83,
        lastQuantityUpdateDate: { day: 31, month: 12, year: 2023 },
        lastPriceUpdateDate: { day: 31, month: 12, year: 2023 },
        ytdChangePercentage: .102,
    },
];

const accounts: { [index: string]: IAccount } = {
    "1": {
        accountId: "1",
        accountTypeCategoryId: "1",
        accountTypeCategoryName: 'Taxable',
        accountTypeName: "Money Market",
        accountCustodian: "Capital One",
        accountName: "Peter's Savings",
    },
    "2": {
        accountId: "2",
        accountTypeCategoryId: "1",
        accountTypeCategoryName: 'Taxable',
        accountTypeName: "Brokerage",
        accountCustodian: "Charles Schwab",
        accountName: "Peter's Investments",
    },
    "3": {
        accountId: "3",
        accountTypeCategoryId: "1",
        accountTypeCategoryName: 'Taxable',
        accountTypeName: "Checking",
        accountCustodian: "Chase Bank",
        accountName: "Joint Checking",
    },
    "4": {
        accountId: "4",
        accountTypeCategoryId: "1",
        accountTypeCategoryName: 'Taxable',
        accountTypeName: "Brokerage",
        accountCustodian: "Fidelity",
        accountName: "Dina's Investments",
    },
    "5": {
        accountId: "5",
        accountTypeCategoryId: "1",
        accountTypeCategoryName: 'Taxable',
        accountTypeName: "Brokerage",
        accountCustodian: "Coinbase",
        accountName: "Peter's Crypto",
    },
    "6": {
        accountId: "6",
        accountTypeCategoryId: "2",
        accountTypeCategoryName: 'Tax Deferred',
        accountTypeName: "Solo 401k",
        accountCustodian: "Fidelity",
        accountName: "Dina's 401k",
    },
    "7": {
        accountId: "7",
        accountTypeCategoryId: "2",
        accountTypeCategoryName: 'Tax Deferred',
        accountTypeName: "Rollover IRA",
        accountCustodian: "Fidelity",
        accountName: "Peter's IRA",
    },
    "8": {
        accountId: "8",
        accountTypeCategoryId: "3",
        accountTypeCategoryName: 'Tax Exempt',
        accountTypeName: "Roth 401k",
        accountCustodian: "Empower",
        accountName: "Dina's Roth 401k",
    },
    "9": {
        accountId: "9",
        accountTypeCategoryId: "3",
        accountTypeCategoryName: 'Tax Exempt',
        accountTypeName: "Roth IRA",
        accountCustodian: "Fidelity",
        accountName: "Peter's Roth IRA",
    },
}

const labels = [
    "12/31/2000",
    "12/31/2001",
    "12/31/2002",
    "12/31/2003",
    "12/31/2004",
    "12/31/2005",
    "12/31/2006",
    "12/31/2007",
    "12/31/2008",
    "12/31/2009",
    "12/31/2010",
    "12/31/2011",
    "12/31/2012",
    "12/31/2013",
    "1/31/2014",
    "2/28/2014",
    "3/31/2014",
    "4/30/2014",
    "5/31/2014",
    "6/30/2014",
    "7/31/2014",
    "8/31/2014",
    "9/30/2014",
    "10/31/2014",
    "11/30/2014",
    "12/31/2014",
    "1/31/2015",
    "2/28/2015",
    "3/31/2015",
    "4/30/2015",
    "5/31/2015",
    "6/30/2015",
    "7/31/2015",
    "8/31/2015",
    "9/30/2015",
    "10/31/2015",
    "11/30/2015",
    "12/31/2015",
    "1/31/2016",
    "2/29/2016",
    "3/31/2016",
    "4/30/2016",
    "5/31/2016",
    "6/30/2016",
    "7/31/2016",
    "8/31/2016",
    "9/30/2016",
    "10/31/2016",
    "11/30/2016",
    "12/31/2016",
    "1/31/2017",
    "2/28/2017",
    "3/31/2017",
    "4/30/2017",
    "5/31/2017",
    "6/30/2017",
    "7/31/2017",
    "8/31/2017",
    "9/30/2017",
    "10/31/2017",
    "11/30/2017",
    "12/31/2017",
    "1/31/2018",
    "2/28/2018",
    "3/31/2018",
    "4/30/2018",
    "5/31/2018",
    "6/30/2018",
    "7/31/2018",
    "8/31/2018",
    "9/30/2018",
    "10/31/2018",
    "11/30/2018",
    "12/31/2018",
    "1/31/2019",
    "2/28/2019",
    "3/31/2019",
    "4/30/2019",
    "5/31/2019",
    "6/30/2019",
    "7/31/2019",
    "8/31/2019",
    "9/30/2019",
    "10/31/2019",
    "11/30/2019",
    "12/31/2019",
    "1/31/2020",
    "2/29/2020",
    "3/31/2020",
    "4/30/2020",
    "5/31/2020",
    "6/30/2020",
    "7/31/2020",
    "8/31/2020",
    "9/30/2020",
    "10/31/2020",
    "11/30/2020",
    "12/31/2020",
    "1/31/2021",
    "2/28/2021",
    "3/31/2021",
    "4/30/2021",
    "5/31/2021",
    "6/30/2021",
    "7/31/2021",
    "8/31/2021",
    "9/30/2021",
    "10/31/2021",
    "11/30/2021",
    "12/31/2021",
    "1/31/2022",
    "2/28/2022",
    "3/31/2022",
    "4/30/2022",
    "5/31/2022",
    "6/30/2022",
    "7/31/2022",
    "8/31/2022",
    "9/30/2022",
    "10/31/2022",
    "11/30/2022",
    "12/31/2022",
    "1/31/2023",
    "2/28/2023",
    "3/31/2023",
    "4/30/2023",
    "5/31/2023",
    "6/30/2023",
    "7/31/2023",
    "8/31/2023",
    "9/30/2023",
    "10/31/2023",
    "11/30/2023",
    "12/31/2023",
    "1/31/2024",
    "2/29/2024",
    "3/31/2024",
  ];
  
  const balances = [
    40000,
    44000,
    -25000,
    50000,
    65000,
    60000,
    90000,
    100000,
    100000,
    150000,
    200000,
    175000,
    300000,
    329900,
    333207,
    337373,
    340455,
    343274,
    343536,
    350667,
    353838,
    357325,
    362625,
    359530,
    363959,
    367218,
    367746,
    370418,
    373412,
    379846,
    381629,
    381509,
    386157,
    389887,
    393319,
    392514,
    396291,
    399436,
    402932,
    399736,
    406232,
    408081,
    408235,
    411789,
    416397,
    420007,
    423990,
    429063,
    431327,
    424972,
    427930,
    435539,
    441453,
    444126,
    447920,
    446514,
    448836,
    451165,
    464405,
    472979,
    473418,
    472673,
    480203,
    478635,
    485451,
    491948,
    498111,
    502680,
    508121,
    512342,
    508052,
    513119,
    517373,
    522518,
    528141,
    531175,
    536878,
    541738,
    540765,
    547006,
    556045,
    560585,
    565623,
    571169,
    571051,
    577595,
    580835,
    585540,
    591253,
    596028,
    599345,
    608669,
    615082,
    617453,
    616742,
    618604,
    623045,
    629071,
    633050,
    638631,
    645850,
    650989,
    656705,
    652613,
    656166,
    664654,
    674350,
    674621,
    681076,
    687018,
    694721,
    699607,
    708602,
    715341,
    721539,
    727183,
    724986,
    733069,
    740012,
    746395,
    752826,
    758051,
    772150,
    784566,
    790630,
    786192,
    793577,
    799701,
    805866,
    816101,
    827135,
    833483,
    833622,
    841402,
    847845,
    847872,
    999999,
];
  